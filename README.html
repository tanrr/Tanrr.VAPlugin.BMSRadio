<!doctype html>
<html id="mdhtml">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=9">
    <title>Markdown preview</title>
    <style>body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  background-color: #313131;
  color: #c3c5c7;
}

@font-face {
  font-family: octicons-link;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

.markdown-body {
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  line-height: 1.5;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  font-size: 16px;
  line-height: 1.5;
  word-wrap: break-word;
}

.markdown-body .pl-c {
  color: #6a737d;
}

.markdown-body .pl-c1,
.markdown-body .pl-s .pl-v {
  color: #005cc5;
}

.markdown-body .pl-e,
.markdown-body .pl-en {
  color: #6f42c1;
}

.markdown-body .pl-smi,
.markdown-body .pl-s .pl-s1 {
  color: #24292e;
}

.markdown-body .pl-ent {
  color: #22863a;
}

.markdown-body .pl-k {
  color: #d73a49;
}

.markdown-body .pl-s,
.markdown-body .pl-pds,
.markdown-body .pl-s .pl-pse .pl-s1,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sre,
.markdown-body .pl-sr .pl-sra {
  color: #032f62;
}

.markdown-body .pl-v,
.markdown-body .pl-smw {
  color: #e36209;
}

.markdown-body .pl-bu {
  color: #b31d28;
}

.markdown-body .pl-ii {
  color: #fafbfc;
  background-color: #b31d28;
}

.markdown-body .pl-c2 {
  color: #fafbfc;
  background-color: #d73a49;
}

.markdown-body .pl-c2::before {
  content: "^M";
}

.markdown-body .pl-sr .pl-cce {
  font-weight: bold;
  color: #22863a;
}

.markdown-body .pl-ml {
  color: #735c0f;
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
  font-weight: bold;
  color: #005cc5;
}

.markdown-body .pl-mi {
  font-style: italic;
  color: #24292e;
}

.markdown-body .pl-mb {
  font-weight: bold;
  color: #24292e;
}

.markdown-body .pl-md {
  color: #b31d28;
  background-color: #ffeef0;
}

.markdown-body .pl-mi1 {
  color: #22863a;
  background-color: #f0fff4;
}

.markdown-body .pl-mc {
  color: #e36209;
  background-color: #ffebda;
}

.markdown-body .pl-mi2 {
  color: #f6f8fa;
  background-color: #005cc5;
}

.markdown-body .pl-mdr {
  font-weight: bold;
  color: #6f42c1;
}

.markdown-body .pl-ba {
  color: #586069;
}

.markdown-body .pl-sg {
  color: #959da5;
}

.markdown-body .pl-corl {
  text-decoration: underline;
  color: #032f62;
}

.markdown-body .octicon {
  display: inline-block;
  vertical-align: text-top;
  fill: currentColor;
}

.markdown-body a {
  background-color: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline-width: 0;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border-style: none;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body hr {
  box-sizing: content-box;
  height: 0;
  overflow: visible;
}

.markdown-body input {
  font: inherit;
  margin: 0;
}

.markdown-body input {
  overflow: visible;
}

.markdown-body [type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body * {
  box-sizing: border-box;
}

.markdown-body input {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

.markdown-body a {
  color: rgba(167, 234, 140, 0.94);
  font-weight: bold;
  text-decoration: none;
}

.markdown-body a:hover {
  text-decoration: underline;
}

.markdown-body strong {
  font-weight: 700;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #dfe2e5;
}

.markdown-body hr::before {
  display: table;
  content: "";
}

.markdown-body hr::after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body table {
  border-spacing: 0;
  border-collapse: collapse;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body h1 {
  font-size: 32px;
  font-weight: 600;
}

.markdown-body h2 {
  font-size: 24px;
  font-weight: 600;
}

.markdown-body h3 {
  font-size: 20px;
  font-weight: 600;
}

.markdown-body h4 {
  font-size: 16px;
  font-weight: 600;
}

.markdown-body h5 {
  font-size: 14px;
  font-weight: 600;
}

.markdown-body h6 {
  font-size: 12px;
  font-weight: 600;
}

.markdown-body p {
  margin-top: 0;
  margin-bottom: 10px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code {
  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body .octicon {
  vertical-align: text-bottom;
}

.markdown-body .pl-0 {
  padding-left: 0 !important;
}

.markdown-body .pl-1 {
  padding-left: 4px !important;
}

.markdown-body .pl-2 {
  padding-left: 8px !important;
}

.markdown-body .pl-3 {
  padding-left: 16px !important;
}

.markdown-body .pl-4 {
  padding-left: 24px !important;
}

.markdown-body .pl-5 {
  padding-left: 32px !important;
}

.markdown-body .pl-6 {
  padding-left: 40px !important;
}

.markdown-body::before {
  display: table;
  content: "";
}

.markdown-body::after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.markdown-body .anchor {
  float: left;
  padding-right: 4px;
  margin-left: -20px;
  line-height: 1;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height:1px;
  padding: 0;
  margin: 24px 0;
  background-color: #828282;
  border: 0;
}

.markdown-body blockquote {
  padding: 0 1em;
  color: #9fa0a0;
  border-left: 0.25em solid #292929;
  font-style: italic;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #444d56;
  vertical-align: middle;
  background-color: #fafbfc;
  border: solid 1px #c6cbd1;
  border-bottom-color: #959da5;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #959da5;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 24px;
  margin-bottom: 16px;
  font-weight: 600;
  line-height: 1.25;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  color: #1b1f23;
  vertical-align: middle;
  visibility: hidden;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  visibility: visible;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2em;
  border-bottom: 1px solid #484848;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.5em;
  border-bottom: 1px solid #484848;
}

.markdown-body h3 {
  font-size: 1.25em;
}

.markdown-body h4 {
  font-size: 1em;
}

.markdown-body h5 {
  font-size: 0.875em;
}

.markdown-body h6 {
  font-size: 0.85em;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li {
  word-wrap: break-all;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body li+li {
  margin-top: 0.25em;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: 600;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body table {
  display: block;
  overflow: auto;
}

.markdown-body table th {
  font-weight: 600;
  background-color: #292929;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #636363;
}

.markdown-body table tr {
  border-top: 1px solid #636363;
}


.markdown-body img {
  max-width: 100%;
  box-sizing: content-box;
}

.markdown-body img[align=right] {
  padding-left: 20px;
}

.markdown-body img[align=left] {
  padding-right: 20px;
}

.markdown-body code {
  padding: 0.2em 0.4em;
  margin: 0;
  font-size: 85%;
  background-color: #292929;
  border: 1px solid #676767;
  border-radius: 3px;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body .highlight pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #292929;
  border-radius: 3px;
}

.markdown-body pre code {
  display: inline;
  max-width: auto;
  padding: 0;
  margin: 0;
  overflow: visible;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body .full-commit .btn-outline:not(:disabled):hover {
  color: #005cc5;
  border-color: #005cc5;
}

.markdown-body kbd {
  display: inline-block;
  padding: 3px 5px;
  font: 11px "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
  line-height: 10px;
  color: #444d56;
  vertical-align: middle;
  background-color: #fafbfc;
  border: solid 1px #d1d5da;
  border-bottom-color: #c6cbd1;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #c6cbd1;
}

.markdown-body :checked+.radio-label {
  position: relative;
  z-index: 1;
  border-color: #0366d6;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 0.2em 0.25em -1.6em;
  vertical-align: middle;
}

.markdown-body hr {
  border-bottom-color: #eee;
}</style>
  </head>
  <body>
    <article class="markdown-body">
      <h1 data-sourcepos="1:1-1:50">Jeeves BMS Radio Menus (Tanrr.VAPlugin.BMSRadio)</h1>
<p data-sourcepos="3:1-3:13">version 0.1.2</p>
<p data-sourcepos="5:1-6:37">Jeeves BMS Radio Menus is a simple but powerful plugin for VoiceAttack
to work with Falcon BMS radio menus.</p>
<p data-sourcepos="8:1-9:45">It is a flexible solution with more features than simpler VA profiles,
while being relatively fast and light weight.</p>
<p data-sourcepos="11:1-17:66">Users can easily call up radio menus by saying a menuTarget
such as &quot;2&quot; or &quot;Flight&quot; followed by an appropriate menuName,
such as &quot;Combat 3.&quot;  The menu is displayed and the plugin
will listen for phrases that match the current menu's menu items.
This lets users who are not familiar with the menus look through
them to make their choices, and will even warn them when
they ask for a menu that doesn't exist such as &quot;Flight, Combat 3.&quot;</p>
<p data-sourcepos="19:1-24:69">The system is designed for flexibility while remaining reasonably simple.
It is easy to update JBMS to match updates to the game,
and to change the recognition phrases for menuTargets, menuNames,
and menuItems to work for you.  Additional ease of use features include
adding direct commands that don't leave menus up, as well as the ability
to have menu items call your own methods in the VoiceAttack profile.</p>
<p data-sourcepos="26:1-30:49">This is a personal project, so so use at your own risk.
With that said, I hope to keep this up to date with new versions of
Falcon BMS and welcome feedback through GitHub's Issue reporting.
The current GitHub project is at
<a href="https://github.com/tanrr/Tanrr.VAPlugin.BMSRadio">https://github.com/tanrr/Tanrr.VAPlugin.BMSRadio</a>.</p>
<h3 data-sourcepos="32:1-32:61"><strong>The extended functionality is what makes this useful:</strong></h3>
<ul data-sourcepos="34:1-73:0">
<li data-sourcepos="34:1-39:0">
<p data-sourcepos="34:3-38:70"><em>All the menus and their data about key combinations are in a
human readable JSON file, so you can change any and all recognition
phrases. You can easily update the JSON to match changes to the
games menu items, or even add new menus as needed.
The VoiceAttack profile is relatively simple to modify to your needs.</em></p>
</li>
<li data-sourcepos="40:1-42:0">
<p data-sourcepos="40:3-41:26"><em>The menu items can be configured to do keypresses or to call your
own named command in VA.</em></p>
</li>
<li data-sourcepos="43:1-46:0">
<p data-sourcepos="43:3-45:40"><em>A particular menu item can be given a custom &quot;callable&quot; name,
so you can add your own VA phrase to directly run that menu item
without waiting (say for &quot;Bogey Dope&quot;).</em></p>
</li>
<li data-sourcepos="47:1-54:0">
<p data-sourcepos="47:3-53:20"><em>Since the list of menuItem phrases in the JSON file are not
directly part of the VA profile, your profile command phrases
can duplicate menuItem phrases without it being a problem.
For example, you can match the direct phrase &quot;Attack My Target&quot;
to execute the menu item for &quot;Wingman, Combat Management 1&quot; without
it causing problems for the &quot;Attack My Target&quot; menu items for Wingman,
Element, or Flight.</em></p>
</li>
<li data-sourcepos="55:1-59:0">
<p data-sourcepos="55:3-58:58"><em>A JSON schema is provided to validate the menu JSON file.
This is done automatically on program load, or you can manually
verify your changes match the schema as you edit the menu file by
using a JSON schema validator like <a href="https://jsonmate.com/">https://jsonmate.com/</a>.</em></p>
</li>
<li data-sourcepos="60:1-63:0">
<p data-sourcepos="60:3-62:18"><em>When the plugin loads the menu JSON it will check your phrases
to make sure you haven't generated duplicate or empty phrases
within each menu.</em></p>
</li>
<li data-sourcepos="64:1-69:0">
<p data-sourcepos="64:3-68:91"><em>To help learn the menus, ask the plugin to list menus by target or name.
&quot;List Wingman Combat Menus&quot;, &quot;List ATC Menus&quot;, &quot;List All Formation Menus&quot;, etc.
Note that to list all menus for a menuTarget you must say something in the format
&quot;List Wingman Menus&quot; (&quot;List All Wingman Menus&quot; won't be understood).
The amount of time each menu is displayed when listing menus is adjustable in the profile.</em></p>
</li>
<li data-sourcepos="70:1-73:0">
<p data-sourcepos="70:3-72:44"><em>To help with radio tuning, VA commands for
&quot;Push [Uniform;Victor] [1..20]&quot; are included, to allow you to
quickly change between UHF and VHF presets.</em></p>
</li>
</ul>
<h2 data-sourcepos="74:1-74:20"><strong>INSTALLATION</strong>:</h2>
<p data-sourcepos="76:1-79:79"><em>This plugin uses Newtonsoft.Json.dll version 13.0.2,
and Newtonsoft.Json.Schema.dll version 3.0.14.<br />
They are included, or you can download your own versions.
Note that STEP 3 copies the Newtonsoft.Json.dll file to a different directory.</em></p>
<h3 data-sourcepos="81:1-81:31">Remove Any Previous Install</h3>
<ul data-sourcepos="83:1-88:0">
<li data-sourcepos="83:1-83:65">Run VoiceAttack and delete or rename &quot;Jeeves BMS Radio Profile&quot;</li>
<li data-sourcepos="84:1-85:47">If renaming, change the active profile so your old profile won't
initialize with the newer version of the plugin</li>
<li data-sourcepos="86:1-86:23">Shut down VoiceAttack</li>
<li data-sourcepos="87:1-88:0">Delete the <strong>Tanrr.VAPlugin.BMSRadio</strong> folder in <strong>..VoiceAttack\Apps</strong></li>
</ul>
<h3 data-sourcepos="89:1-89:23">Install New Version</h3>
<ol data-sourcepos="91:1-107:0">
<li data-sourcepos="91:1-92:80">Make sure that <em>&quot;Enable Plugin Support&quot;</em> is enabled
(VoiceAttack Settings (Wrench icon) under &quot;General&quot;), then shut down VoiceAttack</li>
<li data-sourcepos="93:1-95:54">Move the <strong>Tanrr.VAPlugin.BMSRadio</strong> folder into the folder
<strong>..\VoiceAttack\Apps</strong>.  This should leave the dlls and related files
under <strong>..\VoiceAttack\Apps\Tanrr.VAPlugin.BMSRadio</strong>.</li>
<li data-sourcepos="96:1-98:44"><strong>IMPORTANT</strong>: From the <strong>Tanrr.VAPlugin.BMSRadio</strong> folder,
<strong>COPY</strong> the <strong>Newtonsoft.Json.dll</strong> file into the
<strong>..\VoiceAttack\Shared\Assemblies</strong> folder.</li>
<li data-sourcepos="99:1-99:71">Launch VoiceAttack and import <strong>Jeeves BMS Radio Menus Profile.vap</strong></li>
<li data-sourcepos="100:1-101:33">Shut down, then relaunch VoiceAttack, so the updated profile
can initialize the updated plugin</li>
<li data-sourcepos="102:1-107:0"><em>HOTKEYS:</em> The VoiceAttack profile provided only sets a hotkey
of F24 (hold to listen) for VoiceAttack. You will want to change
the hotkeys to whatever keyboard keys or game controller buttons you use.
Hotkeys can be set globally (VoiceAttack Settings, Hotkeys)
or just for the profile (Edit Profile, Options, Profile Hotkeys).</li>
</ol>
<p data-sourcepos="108:1-108:76">** <em>See recommended VoiceAttack settings at the end of this document</em> **</p>
<h2 data-sourcepos="110:1-110:11">DETAILS:</h2>
<h3 data-sourcepos="112:1-112:13">BMS Menus</h3>
<p data-sourcepos="114:1-116:26">Details of the BMS Radio menus can be found <strong>BMS-Comms-Nav-Book.pdf</strong>
in which is in your BMS folder under <strong>Docs\00 BMS Manuals</strong>.
The relevant sections are:</p>
<ul data-sourcepos="118:1-123:0">
<li data-sourcepos="118:1-118:73">1.1 AIRBASE COMM PLAN: (ATC) Just after the 1.1.7 Contingencies section</li>
<li data-sourcepos="119:1-119:79">2.1.2 Your AI Wingmen/Element/Flight: The Wingman/Element &amp; Flight radio menu</li>
<li data-sourcepos="120:1-120:29">2.2.1 Tactical Net: (AWACS)</li>
<li data-sourcepos="121:1-121:14">2.2.2 Tanker</li>
<li data-sourcepos="122:1-123:0">2.2.3 JTAC</li>
</ul>
<h3 data-sourcepos="124:1-124:15">Limitations</h3>
<ul data-sourcepos="126:1-154:0">
<li data-sourcepos="126:1-128:59">The plugin does not (yet) support comms menus being disabled with g_bDisableCommsMenu 1,
nor does it support switching off the comms menu wit hthe new chatline dot command
<strong>&quot;.commsmenu 0&quot;</strong>.  Support for this may be added later.</li>
<li data-sourcepos="129:1-132:76">The plugin and VA profile currently do not verify that BMS is the active window.
If you are typing (or speaking with the speech recognition button down) this
could cause invalid input.  This is planned to be changed in later versions to only
send keystrokes to BMS or to ignore input if BMS is not the active window.</li>
<li data-sourcepos="133:1-136:38">The plugin uses the default keys for BMS menus
(T for ATC; W/E/R for Wingman/Element/Flight, Q for AWACS,
Y for Tanker/JTAC).  If you have changed these shortcuts you should
edit the JSON to use your shortcuts.</li>
<li data-sourcepos="137:1-140:45">Current menu data is for BMS version 4.37.1 menus.
If you have a newer version of BMS or have modified the menu<br />
by changing the BMS ##Data/Art/CkptArt/menu.dat## file you should
update the JSON file to match your changes.</li>
<li data-sourcepos="141:1-142:34">The plugin's JSON files must be in UTF-8 format and
DO NOT support UTF-16 or UNICODE</li>
<li data-sourcepos="143:1-146:51">menuItemExecute strings currently only support visible characters,
do not support modifiers such as SHIFT, CTRL, or ALT,
and do not support separate numpad characters.
Support for these may be added to later versions.</li>
<li data-sourcepos="147:1-154:0">This plugin is managing asynchronous states without calling into the BMS
code, and without locking data used by VoiceAttack (though it is sharing
state variables between the plugin and the VA profile).<br />
This greatly simplifies the plugin, but it is possible for it to get out
of sync and think it has a menu up when it doesn't or vs. vs.  If this
happens you should just be able to say <em>&quot;Reset Menu&quot;</em>, <em>&quot;Cancel Menu</em>&quot; or
even just <em>&quot;Press Escape&quot;</em> to reset.</li>
</ul>
<h3 data-sourcepos="155:1-155:25">VoiceAttack Variables</h3>
<p data-sourcepos="157:1-162:57"><strong>&gt;JBMS</strong> variables can be changed by the VA profile,
but should only be used in the same way (to pass info to the plugin,
or check return states from the plugin).<br />
Feel free to set the Boolean <strong>_LOG</strong> variables
(initialized in VA command <em>&quot;JBMS Initial Load Init&quot;</em>) to true
for additional logging, with slightly slower performance.</p>
<p data-sourcepos="164:1-166:46"><strong>&gt;JBMSI</strong> internal variables should NOT be changed by the VA profile,
EXCEPT for the provided methods provided that use them.
Changes to them could easily break the plugin.</p>
<pre data-sourcepos="168:1-185:3"><code>\&gt;JBMS_JSON_LOG       Boolean for logging of JSON parsing
\&gt;JBMS_MENU_LOG       Boolean for logging of menu items (shows list of menu items in log)
\&gt;JBMS_STRUCT_LOG     Boolean for logging of data structures manipulation
\&gt;JBMS_VERBOSE_LOG    Boolean for more verbose general logging

&gt;JBMS_MENU_TGT	   ONLY to set menuTarget before calling plugin w/ context &quot;JBMS_SHOW_MENU&quot;
&gt;JBMS_MENU_NAME	   ONLY to set menuName before calling plugin w/ context &quot;JBMS_SHOW_MENU&quot;
&gt;JBMS_DIRECT_CMD   ONLY to set directCommand before calling plugin w/ context &quot;JBMS_DIRECT_CMD&quot;

&gt;JBMSI_NO_SUCH_MENU   READ-ONLY - (Checked &amp; set only by &quot;JBMS Radio Menu Show&quot; command)
&gt;JBMSI_MENU_RESPONSE  READ-ONLY - (Checked &amp; set only by &quot;JBMS Wait For Menu Response&quot; command)

&gt;JBMSI_LISTING_MENUS  INTERNAL, do not use
&gt;JBMSI_MENU_UP        INTERNAL, do not use
&gt;JBMSI_VERSION        INTERNAL, do not use
&gt;&gt;JBMSI_INITED        INTERNAL, do not use
</code></pre>
<h3 data-sourcepos="187:1-187:16">JSON FORMAT:</h3>
<p data-sourcepos="189:1-190:53">The JSON menu file <strong>Tanrr.VAPlugin.Radio.Menus.json</strong> is a top level
array of menus. Each menu has the format shown below.</p>
<p data-sourcepos="192:1-192:22"><strong>EXAMPLE JSON MENU:</strong></p>
<pre data-sourcepos="194:2-214:0"><code>{
	&quot;menuTarget&quot;: &quot;Flight&quot;,
	&quot;targetPhrases&quot;: &quot;Flight&quot;,
	&quot;menuName&quot;: &quot;Miscellaneous 1&quot;,
	&quot;menuNamePhrases&quot;: &quot;[Miscellaneous;Misk] [1;]&quot;,
	&quot;menuShow&quot;: &quot;RRRRRRR&quot;,

	&quot;menuItems&quot;: [
		[ &quot;Fence In&quot;, &quot;1&quot;, &quot;JBMS-FX1-FENCE-IN&quot; ],
		[ &quot;Fence Out&quot;, &quot;2&quot; ],
		[ &quot;Lights [S O P;Ess Oh Pea]&quot;, &quot;3&quot; ],
		[ &quot;Music On&quot;, &quot;4&quot; ],
		[ &quot;Music Off&quot;, &quot;5&quot; ],
		[ &quot;[Turn;] Smoke On&quot;, &quot;6&quot; ],
		[ &quot;[Turn;] Smoke Off&quot;, &quot;7&quot; ],
		[ &quot;[Switch;Push] Flight Uniform&quot;, &quot;DC Push Flight Uniform&quot; ],
		[ &quot;[Switch;Push] Flight Victor&quot;, &quot;9&quot; ],
		[ &quot;Set Bingo&quot;, &quot;0&quot; ]
	]
},
</code></pre>
<p data-sourcepos="215:1-215:13"><strong>REQUIRED:</strong></p>
<ul data-sourcepos="216:1-224:2">
<li data-sourcepos="216:1-216:43">All values are text strings in <em>&quot;Quotes&quot;</em></li>
<li data-sourcepos="217:1-217:81">The combination of menuTarget+menuName must be unique for all menus in the JSON</li>
<li data-sourcepos="218:1-218:68">The menuShow text/command must be unique for all menus in the JSON</li>
<li data-sourcepos="219:1-219:35">All named items must be non-empty</li>
<li data-sourcepos="220:1-224:2">menuItems Array line includes multiple menuItem arrays:
<ul data-sourcepos="221:3-224:2">
<li data-sourcepos="221:3-221:59">First string: <em>menuItemPhrases</em> to match that menu item</li>
<li data-sourcepos="222:3-222:79">Second string: <em>menuItemExecute</em> keys/command to execute for that menu item</li>
<li data-sourcepos="223:3-224:2">Optional third string: <em>menuItemDirectCmd</em> identifier for the menu item so a VA command can call it directly</li>
</ul>
</li>
</ul>
<p data-sourcepos="225:1-225:10"><strong>NOTES:</strong></p>
<ul data-sourcepos="226:3-232:0">
<li data-sourcepos="226:3-232:0"><em>targetPhrases</em> and <em>menuNamePhrases</em> are used internally list menus for
the VA <em>&quot;List Wingman/ATC/All Combat/Formation Menus&quot;</em> command,
and are planned for later functionality.
Make sure they match the VA profile's prefix &amp; suffix phrases for menus.
So if you update the phrases in the VA profile, please update the matching
phrases in the JSON and vs. vs.</li>
</ul>
<p data-sourcepos="233:1-233:51"><strong>WORKING WITH MENU JSON and VOICEATTACK PROFILE:</strong></p>
<p data-sourcepos="235:1-238:45">The menu JSON menu file and schema file should have been installed to
<strong>..\VoiceAttack\Apps\Tanrr.VAPlugin.BMSRadio</strong>. You can use an online
JSON schema validator, like <a href="https://jsonmate.com/">https://jsonmate.com/</a> to validate the menu
JSON against the schema while you work on it.</p>
<p data-sourcepos="240:1-240:46">Menu JSON: <strong>Tanrr.VAPlugin.Radio.Menus.json</strong></p>
<p data-sourcepos="242:1-242:49">Schema JSON: <strong>Tanrr.VAPlugin.Radio.Schema.json</strong></p>
<p data-sourcepos="244:1-244:29">PHRASES TO SELECT MENU ITEMS:</p>
<p data-sourcepos="246:1-251:33"><em>MenuItemPhrases</em> (1st text field in each array within <em>menuItems</em>) are
the VoiceAttack command phrases the plugin will listen for while this
menu is up.  They are the same format as VoiceAttack commands:
multiple options, separated by semi-colons, sub-sections specified by
[brackets].  Note that sub-sections can match to nothing as well by
having a ; with nothing after it.</p>
<p data-sourcepos="253:1-253:79">For example: <em>&quot;[Switch;Push] [Flight;] Uniform&quot;</em> matches all these phrases:</p>
<ul data-sourcepos="254:1-258:0">
<li data-sourcepos="254:1-254:25">&quot;Switch Flight Uniform&quot;</li>
<li data-sourcepos="255:1-255:23">&quot;Push Flight Uniform&quot;</li>
<li data-sourcepos="256:1-256:18">&quot;Switch Uniform&quot;</li>
<li data-sourcepos="257:1-258:0">&quot;Push Uniform&quot;</li>
</ul>
<p data-sourcepos="259:1-263:45">The provided VA profile already includes the command &quot;Press [0..9]&quot;&quot;
which will press the number keys for you, and these work even if the
menu is not up. DO NOT add the menu number as part of the recognition
phrases.  It could interfere with other phrases - for example <em>&quot;2&quot;</em>
and <em>&quot;3&quot;</em> are used as prefix <em>menuTargets</em>.</p>
<p data-sourcepos="265:1-265:26">KEYSTROKES FOR MENU ITEMS:</p>
<p data-sourcepos="267:1-271:53"><em>MenuItemExecute</em> (2nd text field in each array within <em>menuItems</em>) are
normally set to the keystrokes to press when that menu item is chosen.
These keys will be passed to the the VA profile <em>&quot;JBMS Press Keys&quot;</em>
command which will simulate the keypresses.
(Unless they match a VA command as described later.)</p>
<p data-sourcepos="273:1-276:69">You can change the <em>&quot;JBMS Press Keys&quot;</em> command in the VA profile by
adjusting the keypress and pause times.  Those times are set conservatively
long to work on all systems, so if you change the times make sure you
test that they work for busy multiplayer servers and your own system.</p>
<p data-sourcepos="278:1-279:46">See the <em>&quot;DC Push Flight Uniform&quot;</em> command in the VA profile as an
example of using MenuItemExecute as a command.</p>
<p data-sourcepos="281:1-281:51">MAPPING VOICEATTACK PHRASES DIRECTLY TO MENU ITEMS:</p>
<p data-sourcepos="283:1-288:73">Direct Command Calls (to execute a menu item directly <em>from</em> a VA command
phrase without leaving a menu up and waiting for a menu selection) are
made possible by adding a third <em>menuItemDirectCmd</em> string to the array
for that menu item in <em>menuItems</em>. These should be unique and preferably
identify the <em>menuTarget</em>, <em>menuName</em>, and <em>menuItem</em> they're for,
as described in the <em>menuTarget/menuName</em> abbreviations section later on.</p>
<p data-sourcepos="290:1-292:64">To use this functionality, add your own command phrase to the VA profile,
and have it set the <strong>&gt;JBMS_DIRECT_CMD</strong> variable to the command name
before calling the plugin with context set to <em>JBMS_DIRECT_CMD</em>.</p>
<p data-sourcepos="294:1-294:50">The provided VA profile has some examples of this:</p>
<ul data-sourcepos="296:1-300:0">
<li data-sourcepos="296:1-296:84">&quot;Bogey Dope&quot; mapped to &quot;JBMS-QV1-BOGEY-DOPE&quot; (for &quot;AWACS - Vectors&quot;, &quot;Bogey Dope&quot;)</li>
<li data-sourcepos="297:1-297:85">&quot;AWACS Declare&quot; mapped to &quot;JBMS-QV1-BOGEY-DOPE&quot; (for &quot;AWACS - Tactical&quot;, &quot;Declare&quot;)</li>
<li data-sourcepos="298:1-298:89">&quot;Fence In&quot; mapped to the &quot;JBMS-FX1-FENCE-IN&quot; (for &quot;Flight - Miscellaneous&quot;, &quot;Fence In&quot;)</li>
<li data-sourcepos="299:1-300:0">&quot;Attack My Target&quot; mapped to &quot;JBMS-WC1-ATTACK-TGT&quot; (for &quot;2 - Combat 1&quot;, &quot;Attack My Target&quot;)</li>
</ul>
<p data-sourcepos="301:1-304:85">Note that it is OKAY for your VA profile to use phrases that duplicate the phrases
for the various menu items, because (1) the menu item phrases are only listened
for when the specific menu is up, and (2) duplicate phrases that call
JBMS_DIRECT_CMD while a menu is up will be dropped as the menu phrases have priority.</p>
<p data-sourcepos="306:1-306:47">MAPPING MENU ITEMS TO YOUR OWN CUSTOM COMMANDS:</p>
<p data-sourcepos="308:1-314:41">If you set <em>menuItemExecute</em> (2nd text field in each array within <em>menuItems</em>)
to match the name of a <strong>unique</strong> command within the VA profile, the plugin will
execute that command, instead of pressing keys matching the letters in the string.
It is strongly recommended that you make such commands NOT callable by voice to
avoid conflicting menu states.  Your implementation of such a VA command should
NOT call back into the plugin with a &quot;JBMS_DIRECT_COMMAND&quot; for the same menu item
as this would create a never-ending loop.</p>
<p data-sourcepos="316:1-323:35">Your <em>menuItemExecute</em> VA command (if not keypresses) should not be long running
as the plugin will wait for it to return. Your command can look at the
<strong>&gt;JBMS_MENU_TGT</strong> and <strong>&gt;JBMS_MENU_NAME</strong> variables which will still be valid
till your command returns. Your command is responsible for making sure the menu
is dismissed, either by pressing a key to choose a menu item, or by executing
<em>&quot;Dismiss Menu Only&quot;</em> command in the VA profile. Your command SHOULD NOT call
the plugin with context <em>JBMS_RESET_MENU_STATE</em> as that will be done by the
plugin after your command finishes.</p>
<p data-sourcepos="325:1-325:35">CUSTOMIZING THE VOICEATTACK PROFILE</p>
<p data-sourcepos="327:1-330:70">The profile command <em>&quot;JBMS Initial Load Init&quot;</em> sets default logging options.<br />
You can change these to have more logging. You can also change log settings
on the fly with the voice command
<em>&quot;[Enable;Disable] [Jason;Menu;Struct;Struture;Verbose] Logging&quot;</em>.</p>
<p data-sourcepos="332:1-335:36">The amount of time the profile waits for responses for a menu before dismissing
it is set in <em>&quot;JBMS Wait For Menu Response&quot;</em> command, within the
&quot;Wait for spoken response&quot; call. It is currently left at 15 seconds, which is pretty long.
Change it to whatever works for you.</p>
<p data-sourcepos="337:1-339:28">As mentioned earlier, you can change the timing for keypresses and pauses in the
<em>&quot;JBMS Press Keys&quot;</em> command.  Make sure you verify changes work for your system
and the servers you play on.</p>
<p data-sourcepos="341:1-344:35">One word commands to bring up menus, such as &quot;Tower&quot; or &quot;Tanker&quot; have an
optional [Contact;] at the beginning of the phrase.  You can make that phrase
required by removing the brackets and the ';' if you like.  Please edit the
JSON file to have matching phrases.</p>
<p data-sourcepos="346:1-348:178">Though you can add your own commands directly to this JBMS Radio profile,
it is probably better to make your own separate profile and include it from this profile.
This can be done by editing the JBMS Radio profile, clicking OPTIONS, going to the <em>General</em> tab, and adding your profile to the *&quot;Include Commands from Other Profiles&quot; section.</p>
<p data-sourcepos="350:1-351:77">Note that Voice Attack commands that call the *&quot;Internal Reset Menu&quot; command need
to have *&quot;Allow Other Commands to Execute While This One is Running&quot; checked.</p>
<h2 data-sourcepos="354:1-354:44">VOICEATTACK BASICS &amp; RECOMMENDED SETTINGS</h2>
<p data-sourcepos="356:1-356:11"><strong>BASICS:</strong></p>
<ul data-sourcepos="357:1-367:0">
<li data-sourcepos="357:1-358:39"><em>Only have VoiceAttack listen when you are holding down a key -
don't leave it listening all the time.</em></li>
<li data-sourcepos="359:1-360:85">Turn on &quot;Show Confidence Level&quot; in VA Settings (wrench), Recognition tab to see
how well/poorly VA is understanding you.  Turn this off once things are working well.</li>
<li data-sourcepos="361:1-367:0">It is <em>VERY IMPORTANT</em> that you only have the spoken commands you actually
USE enabled for speech.  All commands that you only call into from other commands
but don't say directly should have speech disabled.  Similarly, try to limit the
number of phrases you add to VA profiles.  Otherwise you are making it much more
difficult for VoiceAttack (and my plugin) to understand you.</li>
</ul>
<p data-sourcepos="368:1-368:25"><strong>RECOMMENDED SETTINGS:</strong></p>
<p data-sourcepos="370:1-371:21"><em>VoiceAttack Settings, Recognition tab: See VA docs under &quot;Recognition Tab&quot; for
deeper descriptions.</em></p>
<ul data-sourcepos="373:1-401:0">
<li data-sourcepos="373:1-375:0">
<p data-sourcepos="373:3-374:40"><em>Recognized Speech Delay:</em> 10-30 - Helps VA differentiate between &quot;AWACS&quot; vs
&quot;AWACS Vectors&quot; and combination phrases.</p>
</li>
<li data-sourcepos="376:1-377:0">
<p data-sourcepos="376:3-376:32"><em>Unrecognized Speech Delay:</em> 0</p>
</li>
<li data-sourcepos="378:1-382:0">
<p data-sourcepos="378:3-381:70"><em>Command Weight:</em> 80-98 - Higher values here tell VA to try to make whatever
you are saying fit to one of the phrases in the profile.  If you set this
to 100 it will ALWAYS pick the closest match it can, so be careful.
I have mine set very high, at 98, due to fan noise and a quiet voice.</p>
</li>
<li data-sourcepos="383:1-393:0">
<p data-sourcepos="383:3-383:35"><em>Minimum Confidence Level:</em> 30-70</p>
<p data-sourcepos="385:4-386:164">The minimum confidence level needed for a match. VA might recognize &quot;Combat 1&quot;
but have a low confidence because you didn't say it clearly. Run VA with &quot;Show Confidence Level&quot; enabled to see if how you should adjust this. I have mine at 35.</p>
<p data-sourcepos="388:4-388:85"><strong>NOTE 1:</strong> This can also be set in a profiles options, or for a specific command.</p>
<p data-sourcepos="390:4-392:24"><strong>NOTE 2:</strong> <em>&quot;JBMS Wait For Menu Response&quot;</em> VA Command specifically sets this very low,
as it is extremely likely, since you just called up a menu, that your next words will
be items in the menu.</p>
</li>
<li data-sourcepos="394:1-396:0">
<p data-sourcepos="394:3-395:83"><em>Min Unrecognized Confidence Level:</em> 30-60 - Higher numbers throw out more
&quot;unrecognized&quot; sounds.  Only need to turn this up if you're in a noisy environment.</p>
</li>
<li data-sourcepos="397:1-397:76">
<p data-sourcepos="397:3-397:76">Disable Adaptive Recognition: OFF (unless VA seems to become unresponsive)</p>
</li>
<li data-sourcepos="398:1-398:91">
<p data-sourcepos="398:3-398:91">Disable Acoustic Echo Cancellation: ON (but can effect other apps, and OFF is usually ok)</p>
</li>
<li data-sourcepos="399:1-401:0">
<p data-sourcepos="399:3-399:28">Reject Pending Speech: OFF</p>
</li>
</ul>
<p data-sourcepos="402:1-402:67"><strong>MENUTARGET &amp; MENUNAME ABBREVIATIONS (NOT REQUIRED BUT HELPFUL):</strong></p>
<pre data-sourcepos="403:1-432:5"><code>menuTarget abbreviations:
  W-ingman
  E-lement
  F-light
  T-ATC
  Q-AWACS
  Y-Tanker/JTAC

menuName abbreviations (followed by 1 or 2/3 etc. for multiples)
  C-ombat
  M-ission
  F-ormation
  X-Misc
  R-unway
  
  G-round
  T-ower
  A-pproach
  D-eparture
  N-Common
  C-arrior &amp; LSO
  B-Abort

  Q-Awacts Tactical (so QQ)
  V-Awacs Vectors   (so QV)

  T-Tanker (so YT)
  J-JTAC (so YJ)
</code></pre>
<p data-sourcepos="433:1-434:52">For example, Wingman, Combat 1 menu for Attack My Target
would be &quot;JBMS-WC1-ATTACK-TGT&quot; or something similar.</p>

    </article>
  </body>
</html>
